<div ng-controller="ExchangePendingController" ng-init="getData(selectedTimeframe)">
  <div class="row om-row"
    <div class="text-left om-title">{{ 'EXCHANGE.MYOFFERS.TITLE' | translate}}</div>
  </div>
  <div ng-show="pendingThinking" class="row">
    <div ng-show="orderbook.length == 0" class="col-xs-12 text-center">{{'COMMON.LOADING' | translate}}...<img src="/assets/img/spinner.gif"></div>
    
    <tabset ng-init="showoffers='buy'" ng-hide="orderbook.length == 0">
      <tab heading="{{ 'EXCHANGE.MYOFFERS.BUYTITLE' | translate }}" active="showoffers=='buy" select="showoffers='buy'">
        <h3> {{ 'EXCHANGE.MYOFFERS.BUYTITLE' | translate }} </h3>
        <table class="table table-striped table-hover table-condensed">
          <thead>
              <tr>
                <th>Transaction hash</th>
                <th>Price per Coin </th>
                <th>Amount</th>
                <th>Total Cost</th>
                <th> Buy </th>
              </tr>
          </thead>
          <tbody>
            <tr ng-repeat="transaction in filtered_buys">
              <td ng-click="setHashExplorer(transaction)"> <a href="/explorer/inspector?view={{transaction.tx_hash}}">{{transaction.tx_hash_concat}}</a></td>
              <td ng-if="transaction.formatted_price_per_coin" class="number" title="{{transaction.formatted_price_per_coin}}" ng-bind-html="transaction.formatted_price_per_coin | numeraljs: '0,0.00000000'"></td> 
              <td ng-if="transaction.formatted_amount" class="number" title="{{transaction.formatted_amount}}" ng-bind-html="transaction.formatted_amount | numeraljs: '0,0.00000000'"></td> 
              <td ng-if="transaction.bitcoin_required" class="number" title="{{transaction.bitcoin_required}}" ng-bind-html="transaction.bitcoin_required | numeraljs: '0,0.00000000'"></td> 
              <td ng-show="(transaction.tx_hash.length == 64 && transaction.payment_expired == false)">
                <button class="btn btn-primary btn-sm" ng-click="purchaseCoin(transaction)" type="submit">Purchase coin</button>
              </td>
                
              <td ng-show="(transaction.payment_expired == true)"> Offer Expired
              </td>
            </tr>
          </tbody>
        </table>
      </tab>
      <tab heading="{{ 'EXCHANGE.MYOFFERS.SELLTITLE' | translate }}" active="showoffers=='sell" select="showoffers='sell'">
        <h3 ng-hide="orderbook.length == 0"> {{ 'EXCHANGE.MYOFFERS.SELLTITLE' | translate }} </h3>
        <table ng-hide="orderbook.length == 0" class="table table-striped table-hover table-condensed">
          <thead>
              <tr>
                <th>Transaction hash</th>
                <th>Price per Coin </th>
                <th>Amount</th>
                <th>Total Cost</th>
                <th> Cancel </th>
              </tr>
          </thead>
          <tbody>
            <tr ng-repeat="transaction in filtered_sells">
              <td ng-click="setHashExplorer(transaction)"> <a href="/explorer/inspector?view={{transaction.tx_hash}}">{{transaction.tx_hash_concat}}</a></td>
              <td class="number" title="{{transaction.formatted_price_per_coin}}" ng-bind-html="transaction.formatted_price_per_coin | numeraljs: '0,0.00000000'"></td> 
              <td class="number" title="{{transaction.formatted_amount}}" ng-bind-html="transaction.formatted_amount | numeraljs: '0,0.00000000'"></td> 
              <td class="number" title="{{transaction.bitcoin_required}}" ng-bind-html="transaction.bitcoin_required | numeraljs: '0,0.00000000'"></td> 
              <td><button class="btn btn-primary btn-sm" ng-click="confirmCancel(transaction)" type="submit">Cancel Offer</button></td>
            </tr>
          </tbody>
        </table>
      </tab>
    </tabset>
  </div>

  <div class="row" ng-hide="pendingThinking">
    <h4>
      <a ng-click="pendingThinking = true"> <strong> < {{ 'COMMON.BACK' | translate}} </strong> </a>
    </h4>
    <div ng-controller="WalletSendAssetsController">
      <div class="row">
        <h3 class="text-center" >Send payment form</h3>
        <br>
        <div ng-show="showErrors" class="alert alert-danger"> <strong> {{error}} </strong> </div> 
      </div>
      <form name="sendForm" ng-submit="changeValue();validateForm()">
      <div class="row">
        <div class="col-xs-6">
          <h4 class="text-justify" >Send type of coin:</h4>
          <div class="form-inline">
              <select name="coin" class="form-control" ng-model="walletAssets.selectedCoin"
                ng-options="currency as currency.name for currency in currencyList"
                ng-change="setBalance()" ng-init="setBalance()" disabled>
                <option value=""> -- Choose Coin -- </option>
              </select>
            </div> 
          <h6 class="text-justify"> To complete a pending offer, you must make purchases in Bitcoin.</h6> 
          <h4 class="text-justify" >Send from address:</h4>
          <div class="form-inline">
             <select name="sender" class="form-control" ng-model="walletAssets.selectedAddress"
                ng-options="address for address in addressList"
                ng-change="setBalance()" ng-init="setBalance()" disabled>
                <option value=""> -- Choose Address -- </option>
              </select>
            </div> 
          <h6 class="text-justify">  
          Note that we allow you to only make payment from addresses with a valid private key. </h6>
        </div>
        <div class="col-xs-6">
          <h4>Blocks Remaining</h4>
          <span ng-class="{'text-primary' : remainingBlocks > 4, 'text-warning': remainingBlocks == 4, 'text-danger': remainingBlocks < 4}" tooltip="Your payment must be received within this many blocks to complete successfully">{{remainingBlocks}} blocks</span>
        </div>
      </div>
        <br>
      <div class="row">
        <div class="col-xs-12">
          <div class="input-group">
            <span class="input-group-addon"> Send funds to:</span>
            <input name="reciever" type="text" ng-model="sendTo" class="form-control" disabled>

          </div>
          <br>
          <div class="input-group">
            <span class="input-group-addon"> Amount to send (in {{selectedCoin.symbol}}): </span>
              <input name="amount" type="number" class="form-control" placeholder="{{sendAmount}}" ng-disabled="true">
            <span class="input-group-addon"> Available: {{balanceData[1]}} {{selectedCoin.symbol}}</span>
          </div>
          <br>
          <div class="input-group">
            <span class="input-group-addon"> Transaction/Miner fees (in BTC): </span>
            <input name="fees" type="number" step="0.00000001" ng-model="minerFees" class="form-control" 
            placeholder="0.0001 minimum" required>
            <span class="input-group-addon" > 
              Available Bitcoin: {{ balanceData[1]}} {{selectedCoin.symbol}}
              </span>
          </div>
          <input ng-model="marked" ng-hide="true" ng-init="marked = true" type="checkbox"> 
        </div>
      </div>
        <br>
      <input class="btn btn-primary btn-lg col-xs-push-3 col-xs-6" type="submit" value="Send Payment">
      </form>
    </div>
  </div>
</div>
