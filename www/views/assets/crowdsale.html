<div ng-controller="WalletAssetsFormController">
  <div ng-controller="TransactionGenerationController">
    <div ng-controller="CrowdsaleIssuanceController">
      <div class="row">
         <div class="col-xs-12 text-left om-title">{{'ASSET_CROWDSALE_TITLE' | translate}}</div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <form name="issuanceForm" ng-submit="validateIssuanceForm()">
            <div class="container-fluid" ng-include="'/views/assets/partials/form_details.html'">
            </div>
            <div class="container-fluid">
              <div class="row">
                <div class="col-xs-12">
                  <h3 class="om-subtitle" >{{'ASSET_CROWDSALE_SUBTITLE' | translate}}</h3>
                  <hr>
                </div>
              </div>
              <div class="form-group">
                <div class="row">
                  <div class="col-xs-6" style="padding-top: 34px">
                    <div class="input-group">
                      <span class="input-group-addon">{{'ASSET_CROWDSALE_DEADLINE' | translate}}</span>
                      <input type="text" class="form-control" datepicker-append-to-body="true" datepicker-popup="{{format}}" ng-model="deadline"
                      is-open="opened" min-date="today" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" />
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="open($event)">
                          <i class="glyphicon glyphicon-calendar"></i>
                        </button> </span>
                    </div>
                  </div>
                  <div class="col-xs-6">
                    <div class="col-xs-5">
                      <timepicker ng-model="deadline"></timepicker>
                    </div>
                    <div class="col-xs-7" style="padding-top: 45px">
                      {{'ASSET_CROWDSALE_UTC' | translate}}
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-addon">{{'ASSET_CROWDSALE_FORISSUER' | translate}} 
                    <a href=""
                      tooltip="{{'ASSET_CROWDSALE_FORISSUER_TOOLTIP' | translate}}"
                      tooltip-append-to-body="true"
                      tooltip-placement="top"> <strong>(?)</strong>
                    </a></span>
                  <input name="percentage" type="number" step="1" min="0" max="255" ng-model="percentageForIssuer" class="form-control" placeholder="For example: 10 (Max 255)" ensure-integer ensure-over="percentageForIssuer" ensure-if="true" required>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-addon">{{'ASSET_CROWDSALE_EARLYBONUS' | translate}} 
                    <a href=""
                      tooltip="{{'ASSET_CROWDSALE_EARLYBONUS_TOOLTIP' | translate}}"
                      tooltip-append-to-body="true"
                      tooltip-placement="top"> <strong>(?)</strong>
                    </a></span>
                  <input name="early" type="number" step="1" min="0" max="255" ng-model="earlyBirdBonus" class="form-control" placeholder="For example: 25 (Max 255)" ensure-integer ensure-over="earlyBirdBonus" ensure-if="true" required>
                </div>
                <p class="help-block" ng-show="earlyBirdBonus > 0">{{'ASSET_CROWDSALE_EARLYESTIMATE' | translate}} 
                  <a href=""
                    tooltip="{{'ASSET_CROWDSALE_EARLYESTIMATE_TOOLTIP' | translate}}"
                    tooltip-append-to-body="true"
                    tooltip-placement="top"> <strong>(?)</strong>
                  </a> {{initialEarlyBirdBonus}}%</p>
              </div>
              <div class="form-group">
                <div class="panel panel-default" ng-repeat="investment in currenciesDesired">
                  <div class="panel-body form-inline">
                    <div class="form-group col-xs-5">
                      <input name="amount" type="text" ng-model="investment.numberOfTokens" big-number step="{{tokenStep}}" min="{{tokenMin}}" max="{{tokenMax}}" ensure-integer ensure-over="investment.numberOfTokens" ensure-if="!isDivisible()" class="form-control" placeholder="# of tokens" required>
                    </div>
                    <div class="form-group col-xs-7">
                      <label>{{'ASSET_CROWDSALE_PER' | translate}}</label>
                      <select class="form-control" name="currencyDesired" ng-model="investment.selectedCurrency"
                        ng-options="currency as formatCurrencyDisplay(currency) for currency in investment.availableTokens"
                        ng-change="setAvailableTokens(investment)">
                      </select>
                      <label>{{'ASSET_CROWDSALE_INVESTED' | translate}}</label>
                    </div>
                    <button type="button" class="close" aria-hidden="true" ng-hide="singleCurrency" ng-click="removeCurrencyDesired(investment)">
                      &times;
                    </button>
                  </div>
                </div>
              </div>
              <div class="panel panel-default" ng-hide="true">
                <div class="panel-body">
                  <button type="button" class="btn btn-link" ng-click="addCurrencyDesired()">
                    {{'ASSET_CROWDSALE_ADDCURRENCY' | translate}}
                  </button>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-addon"> Issuance Address: </span>
                  <select name="issuer" class="form-control" ng-model="walletAssets.selectedAddress"
                  ng-options="address for address in addressList"
                  ng-change="setBalance()" ng-init="setBalance()" required>
                    <option value=""> -- Choose Address -- </option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-addon"> Miner fees ( BTC ): </span>
                  <input name="fees" type="number" ng-model="minerFees" class="form-control"
                  placeholder="0.0001 suggested minimum" step="0.0001" min="0.0001" required>
                  <span class="input-group-addon" > Available Bitcoin: {{ balanceData[1] }} BTC </span>
                </div>
              </div>
              <div class="row">
                <input class="btn btn-primary btn-lg col-xs-push-3 col-xs-6" type="submit" value="Start Crowdsale" ng-click="validateForm()">
              </div>
            </div>
          </form>
          <div class="row">
            <div ng-show="showErrors" class="alert alert-danger">
             <strong> {{error}} </strong>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
